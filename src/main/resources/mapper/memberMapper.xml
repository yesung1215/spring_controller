<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.oauth.mapper.MemberMapper">
    <select id="select" parameterType="Long" resultType="MemberVO">
        SELECT
            ID, MEMBER_EMAIL, MEMBER_PASSWORD, MEMBER_PICTURE_PATH,
            MEMBER_PICTURE_NAME, MEMBER_NAME, MEMBER_NICKNAME, MEMBER_PROVIDER
        FROM TBL_MEMBER
        WHERE ID = #{id}
    </select>

    <select id="selectIdByMemberEmail" parameterType="String" resultType="Long">
        SELECT ID
        FROM TBL_MEMBER
        WHERE MEMBER_EMAIL = #{memberEmail}
    </select>

    <select id="selectAll" resultType="MemberVO">
        SELECT
        ID, MEMBER_EMAIL, MEMBER_PASSWORD, MEMBER_PICTURE_PATH,
        MEMBER_PICTURE_NAME, MEMBER_NAME, MEMBER_NICKNAME, MEMBER_PROVIDER
        FROM TBL_MEMBER
    </select>

    <select id="existsByMemberEmail" parameterType="String" resultType="_boolean">
        SELECT
            CASE
                WHEN COUNT(ID) > 0 THEN 1 ELSE 0
            END
        FROM TBL_MEMBER
        WHERE MEMBER_EMAIL = #{memberEmail}
    </select>

    <!-- 일반 멤버 추가 -->
    <insert id="insert" parameterType="MemberVO">
        INSERT INTO TBL_MEMBER(ID, MEMBER_EMAIL, MEMBER_PASSWORD, MEMBER_PICTURE_PATH, MEMBER_PICTURE_NAME, MEMBER_NAME, MEMBER_NICKNAME, MEMBER_PROVIDER)
        VALUES (SEQ_MEMBER.NEXTVAL, #{memberEmail}, #{memberPassword}, #{memberPicturePath}, #{memberPictureName}, #{memberName}, #{memberNickname}, #{memberProvider})
    </insert>

    <!-- 소셜 멤버 추가 -->
    <insert id="insertSocial" parameterType="MemberInsertSocialVO">
        INSERT INTO TBL_MEMBER(ID, MEMBER_EMAIL, MEMBER_PICTURE_PATH, MEMBER_PICTURE_NAME, MEMBER_NAME, MEMBER_NICKNAME, MEMBER_PROVIDER)
        VALUES (SEQ_MEMBER.NEXTVAL, #{memberEmail}, #{memberPicturePath}, #{memberPictureName}, #{memberName}, #{memberNickname}, #{memberProvider})
    </insert>

    <update id="update" parameterType="MemberVO">
        UPDATE TBL_MEMBER
        SET
            MEMBER_PASSWORD = #{memberPassword}, MEMBER_PICTURE_PATH = #{memberPicturePath}, MEMBER_PICTURE_NAME = #{memberPictureName},
            MEMBER_NAME = #{memberName}, MEMBER_NICKNAME = #{memberNickname}, MEMBER_PROVIDER = #{memberProvider}
        WHERE ID = #{id}
    </update>

    <delete id="delete" parameterType="Long">
        DELETE FROM TBL_MEMBER
        WHERE ID = #{id}
    </delete>

</mapper>